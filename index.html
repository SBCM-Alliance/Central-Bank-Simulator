<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­å¤®éŠ€è¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ - Central Bank Simulator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #1a237e; --accent: #ffd600; --bg: #f5f7f9; --dark: #263238; --error: #d32f2f; --success: #2e7d32; --market: #0288d1; --real: #f4511e; --gov: #673ab7; }
        body { font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif; background-color: var(--bg); color: #333; margin: 0; padding: 10px; line-height: 1.4; }
        .container { max-width: 1250px; margin: 0 auto; display: flex; flex-direction: column; gap: 10px; }
        @media (min-width: 992px) { .container { display: grid; grid-template-columns: 400px 1fr; gap: 20px; } }
        .card { background: #fff; padding: 18px; border-radius: 14px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); margin-bottom: 5px; }
        h1 { color: var(--primary); font-size: 1rem; margin: 0 0 12px 0; border-left: 5px solid var(--primary); padding-left: 10px; font-weight: bold; }
        .rate-display { font-size: 2.8rem; font-weight: bold; color: var(--primary); text-align: center; display: block; margin: 5px 0; }
        input[type="range"] { width: 100%; margin: 10px 0; height: 10px; cursor: pointer; }
        .btn-policy-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-top: 5px; }
        .btn-policy { padding: 10px 5px; border: 1px solid #ddd; background: #fff; color: #444; font-size: 0.7rem; border-radius: 6px; cursor: pointer; font-weight: bold; text-align: center; display: flex; flex-direction: column; justify-content: center; min-height: 60px; }
        .btn-policy.active { background: var(--gov); color: white; border-color: var(--gov); }
        .btn-policy span { font-size: 0.55rem; opacity: 0.8; font-weight: normal; margin-top: 2px; }
        .metric-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 10px; }
        .metric-card { background: #fff; border: 1px solid #ddd; padding: 10px; border-radius: 10px; text-align: center; }
        .val { font-size: 1.1rem; font-weight: bold; display: block; }
        .wallet-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .wallet-stat { padding: 10px; border-radius: 8px; color: white; text-align: center; }
        .bg-income { background: #43a047; } .bg-outcome { background: #e53935; }
        .reaction-item { padding: 8px; border-radius: 6px; font-size: 0.75rem; border: 1px solid #eee; margin-top: 5px; line-height: 1.3; }
        .bg-gov { background: #f1f8e9; border-left: 4px solid #689f38; }
        .bg-biz { background: #e3f2fd; border-left: 4px solid #1976d2; }
        .bg-home { background: #fff3e0; border-left: 4px solid #f57c00; }
        .footer-note { text-align: center; font-size: 0.65rem; color: #999; padding: 15px; }
    </style>
</head>
<body>

    <header style="text-align:center; padding: 10px 0;">
        <h2 style="font-size:1.4rem; color:var(--primary); margin:0; font-weight: 900;">ğŸ¦ ä¸­å¤®éŠ€è¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>
        <div style="font-size:0.75rem; opacity:0.6; font-family: monospace;">v2.0 | <span id="clock">--:--:--</span></div>
    </header>

    <div class="container">
        <div class="left">
            <!-- å¤–éƒ¨æƒ…å‹¢ -->
            <div class="card" style="background: var(--dark); color:white; border:none;">
                <h1 style="color:white; border-left-color: var(--accent);">ğŸ“¡ ä¸–ç•Œæƒ…å‹¢åŒæœŸ</h1>
                <button onclick="syncWorld()" style="background:var(--accent); border:none; width:100%; padding:10px; font-weight:bold; border-radius:8px; cursor:pointer;">æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’åŒæœŸ ğŸ”„</button>
                <div id="news-feed" style="background:#000; color:#00e676; padding:8px; font-family:monospace; font-size:0.7rem; height:70px; overflow-y:auto; margin-top:8px; border:1px solid #444;">> å¾…æ©Ÿä¸­...</div>
                <div id="usa-rate-info" style="font-size:0.7rem; margin-top:5px; text-align:right; color:#aaa;">ç±³FRBé‡‘åˆ©(æƒ³å®š): 4.75%</div>
            </div>

            <!-- æ“ä½œãƒ¬ãƒãƒ¼ -->
            <div class="card">
                <h1>ğŸ›ï¸ é‡‘èãƒ»è³‡æœ¬ãƒ¬ãƒãƒ¼</h1>
                <small>æ”¿ç­–é‡‘åˆ© [æ—¥æœ¬éŠ€è¡Œ]</small>
                <span class="rate-display" id="rate-display">0.75%</span>
                <input type="range" id="rate-slider" min="-0.1" max="5.0" step="0.05" value="0.75">
                
                <!-- ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®è¡¨ç¤ºã¨ã‚¿ã‚¤ãƒˆãƒ«ã‚’ä¿®æ­£ -->
                <small>å®¶è¨ˆé‚„å…ƒ â‡” å†…éƒ¨ç•™ä¿ ã®é…åˆ† [çµŒæ¸ˆç•Œ]</small>
                <input type="range" id="greed-slider" min="0" max="100" step="1" value="50">
                <div style="display: flex; justify-content: space-between; font-size: 0.65rem; color: #999; margin-top:-5px; font-weight: bold;">
                    <span style="color:var(--success)">â† å®¶è¨ˆã¸é‚„å…ƒ(è³ƒä¸Šã’)</span>
                    <span style="color:var(--error)">å†…éƒ¨ç•™ä¿(ç¾é‡‘ã®å‡çµ) â†’</span>
                </div>
            </div>

            <!-- æ”¿åºœã®è²¡å¸ƒ -->
            <div class="card" style="border-top: 5px solid #43a047;">
                <h1>ğŸ‘› æ”¿åºœã®è²¡å¸ƒï¼ˆ1ä¸–å¸¯ã‚ãŸã‚Šã®æœˆé–“äºˆç®—ã«æ›ç®—ï¼‰</h1>
                <div class="wallet-grid">
                    <div class="wallet-stat bg-income"><small>ç¨å</small><span class="amount" id="gov-income">--ä¸‡</span></div>
                    <div class="wallet-stat bg-outcome"><small>æ”¯å‡º</small><span class="amount" id="gov-outcome">--ä¸‡</span></div>
                </div>
                <div id="wallet-balance" style="text-align:center; font-weight:bold; margin-top:8px; font-size:0.8rem;"></div>
            </div>
        </div>

        <div class="right">
            <!-- ã‚°ãƒ©ãƒ• -->
            <div class="card">
                <h1>ğŸ“ˆ çµŒæ¸ˆæŒ‡æ¨™ (é’:å¸‚å ´ / æ©™:ç”Ÿæ´»)</h1>
                <div style="height: 280px;"><canvas id="mainChart"></canvas></div>
            </div>

            <!-- é‡‘åˆ©å·®ãƒã‚°ã‚’ä¿®æ­£ã—ãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹ -->
            <div class="metric-grid">
                <div class="metric-card"><small>æƒ³å®šãƒ»å††ç›¸å ´</small><span class="val" id="yen-val">--å††</span></div>
                <div class="metric-card"><small>æ—¥ç±³é‡‘åˆ©å·®</small><span class="val" id="gap-val">--%</span></div>
                <div class="metric-card"><small>å®Ÿè³ªè³¼è²·åŠ›åˆ¤å®š</small><span class="val" id="wage-val">--</span></div>
            </div>

            <!-- å„å±¤ã®åå¿œ -->
            <div class="card" style="border-top: 5px solid var(--error);">
                <h1>ğŸ‘¥ ç¤¾ä¼šã®æ‚²é³´ã¨åå¿œ</h1>
                <div class="reaction-item bg-gov" id="react-gov">ğŸ›ï¸ æ”¿åºœ: --</div>
                <div class="reaction-item bg-biz" id="react-biz">ğŸ­ çµŒæ¸ˆç•Œ: --</div>
                <div class="reaction-item bg-home" id="react-home">ğŸ  å®¶è¨ˆ: --</div>
                <div id="boj-briefing" style="font-size:0.75rem; color:#666; margin-top:8px; padding:8px; background:#fffde7; border-radius:4px;">æƒ…å‹¢ã‚’åŒæœŸã—ã¦ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚</div>
            </div>

            <!-- ä»‹å…¥æ”¿ç­– -->
            <div class="card" style="border-top: 5px solid var(--gov); background: #f3e5f5;">
                <h1>ğŸ›ï¸ æ”¿åºœã®ä»‹å…¥æ”¿ç­–</h1>
                <div class="btn-policy-grid">
                    <button class="btn-policy" id="p1" onclick="togglePolicy('p1')">æ‰€å¾—ç¨ãƒ»ç¤¾ä¿æ¸›ç¨<span>å®¶è¨ˆã®ã€Œã‚¢ãƒ¼ã‚¹ã€ã‚’å¼·åŒ–</span></button>
                    <button class="btn-policy" id="p2" onclick="togglePolicy('p2')">æ¶ˆè²»ç¨ã®å®Œå…¨å»ƒæ­¢<span>ã€æ³¨ã€‘ç‹‚çƒˆãªã‚¤ãƒ³ãƒ•ãƒ¬ã‚’èª˜ç™º</span></button>
                    <button class="btn-policy" id="p3" onclick="togglePolicy('p3')">å†…éƒ¨ç•™ä¿ã¸ã®èª²ç¨<span>æºœã‚è¾¼ã‚“ã é‡‘ã‚’å®¶è¨ˆã¸è§£æ”¾</span></button>
                    <button class="btn-policy" id="p4" onclick="togglePolicy('p4')">ä¸€å¾‹10ä¸‡å††çµ¦ä»˜<span>çŸ­æœŸçš„ã ãŒç‰©ä¾¡ã‚’æŠ¼ã—ä¸Šã’ã‚‹</span></button>
                    <button class="btn-policy" id="p5" onclick="togglePolicy('p5')">è¡Œæ”¿ã®å¾¹åº•åŠ¹ç‡åŒ–<span>ä¸­æŠœãã‚’æ’é™¤ã—è² æ‹…ã‚’æ¸›ã‚‰ã™</span></button>
                    <button class="btn-policy" id="p6" onclick="togglePolicy('p6')">é£Ÿæ–™ãƒ»ã‚¨ãƒè‡ªçµ¦æŠ•è³‡<span>ã€5å¹´ã€‘ç¾åœ¨ã¯æŠ•è³‡å…ˆè¡ŒæœŸ</span></button>
                    <button class="btn-policy" id="p7" onclick="togglePolicy('p7')">å…¬å…±äº‹æ¥­ã®ãƒãƒ©ãƒã‚­<span>æ ªä¾¡ã¯ä¸ŠãŒã‚‹ãŒä¸­æŠœãå¤§</span></button>
                    <button class="btn-policy" id="p8" onclick="togglePolicy('p8')">ç·Šç¸®è²¡æ”¿ (è¦å¾‹é‡è¦–)<span>ã€æ³¨ã€‘å®¶è¨ˆã‹ã‚‰é‡‘ã‚’å¸ã„ä¸Šã’ã‚‹</span></button>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer-note">
        â€» å®Ÿéš›ã®çµŒæ¸ˆè²¬ä»»ã¯åˆ†æ•£ã—ã¦ãŠã‚Šã€å˜ç‹¬ã§ã®åˆ¶å¾¡ã¯ä¸å¯èƒ½ã§ã™ã€‚<br>
        Â© 2026 SBCM Alliance
    </footer>

    <script>
        let currentRate = 0.75;
        let greedLevel = 50; // 0=é‚„å…ƒæœ€å¤§, 100=ç•™ä¿æœ€å¤§
        let usaRate = 4.75;
        let p = { p1: false, p2: false, p3: false, p4: false, p5: false, p6: false, p7: false, p8: false };

        const ctx = document.getElementById('mainChart').getContext('2d');
        const mainChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['æ ªä¾¡', 'å††ä¾¡å€¤', 'ç‰©ä¾¡', 'ãƒ­ãƒ¼ãƒ³', 'æ‰‹å–ã‚Š'],
                datasets: [{
                    data: [100, 100, 100, 100, 100],
                    backgroundColor: ['#0288d1', '#03a9f4', '#f4511e', '#ff7043', '#fb8c00'],
                    borderRadius: 5
                }]
            },
            options: { 
                responsive: true, 
                maintainAspectRatio: false, 
                scales: { y: { min: -150, max: 200, grid: { color: '#eee' } } }, 
                plugins: { legend: { display: false } } 
            }
        });

        function update() {
            document.getElementById('rate-display').innerText = currentRate.toFixed(2) + "%";
            
            // é‡‘åˆ©å·®ã®è¨ˆç®—ã¨è¡¨ç¤ºã‚’åŒæœŸ
            const gap = usaRate - currentRate;
            document.getElementById('gap-val').innerText = gap.toFixed(2) + "%";
            document.getElementById('usa-rate-info').innerText = `ç±³FRBé‡‘åˆ©(æƒ³å®š): ${usaRate.toFixed(2)}%`;

            // 1. æ”¿åºœã®è²¡å¸ƒè¨ˆç®—
            let bInc = 150; let bOut = 200;
            let inflationShield = 1.0;
            let structureDistortion = 1.0;
            let efficiency = 1.0;
            let inflationPush = 0;

            if (p.p1) bInc -= 40; 
            if (p.p2) { bInc -= 60; inflationPush += 40; }
            if (p.p8) bOut -= 50;
            if (p.p4) { bOut += 70; inflationPush += 15; }
            if (p.p7) { bOut += 40; structureDistortion += 0.3; }
            if (p.p5) { efficiency = 0.75; bOut -= 10; }
            if (p.p6) { bOut += 50; structureDistortion += 0.15; inflationShield = 0.95; inflationPush += 5; }
            
            // P3: å†…éƒ¨ç•™ä¿èª²ç¨ï¼ˆã“ã‚Œã‚’æŠ¼ã™ã¨ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ãŒå·¦ï¼é‚„å…ƒå´ã«å¼·åˆ¶ç§»å‹•ã™ã‚‹æ¼”å‡ºï¼‰
            if (p.p3) { bInc += 30; greedLevel = Math.max(0, greedLevel - 20); }

            let totalOut = bOut + (currentRate * 15);
            let totalInc = bInc + (greedLevel > 60 ? 15 : 5);
            document.getElementById('gov-income').innerText = Math.round(totalInc) + "ä¸‡";
            document.getElementById('gov-outcome').innerText = Math.round(totalOut) + "ä¸‡";
            
            let bal = totalInc - totalOut;
            document.getElementById('wallet-balance').innerText = bal < 0 ? `è²¡æ”¿èµ¤å­—: ${Math.abs(Math.round(bal))}ä¸‡ (ç¤¾ä¼šã¸æ”¾å‡º)` : `è²¡æ”¿é»’å­—: ${Math.round(bal)}ä¸‡ (ç¤¾ä¼šã‹ã‚‰å›å)`;
            document.getElementById('wallet-balance').style.color = bal < 0 ? 'var(--real)' : 'var(--success)';

            // 2. æŒ‡æ¨™è¨ˆç®—
            // å†…éƒ¨ç•™ä¿ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®ãƒ­ã‚¸ãƒƒã‚¯ï¼šgreedLevelãŒ0(å·¦)ã«è¿‘ã„ã»ã©å®¶è¨ˆã¸ã®ãƒœãƒ¼ãƒŠã‚¹ãŒå¤§ãã„
            let incomeBonus = (totalOut - totalInc) * 0.7 + ((100 - greedLevel) * 0.4);
            
            const stock = (100 - (currentRate * 10) + (usaRate * 4) + (greedLevel * 0.5) + (p.p7 ? 20 : 0)) / structureDistortion;
            const yenVal = 100 - (gap * 9); 
            const inflation = (100 + (gap * 15) - (currentRate * 8) + inflationPush) * inflationShield;
            const mortgage = (100 + (currentRate * 55)) * efficiency;
            
            // æ‰‹å–ã‚Šè¨ˆç®—
            let realInc = 100 + incomeBonus - ((inflation - 100) * 1.8) - ((mortgage - 100) * 1.0) + (currentRate * 2);

            mainChart.data.datasets[0].data = [stock, yenVal, inflation, mortgage, realInc];
            mainChart.data.datasets[0].backgroundColor[4] = realInc < 0 ? '#b71c1c' : (realInc > 110 ? '#2ecc71' : '#fb8c00');
            mainChart.update();

            document.getElementById('yen-val').innerText = (142 + (gap * 4.8)).toFixed(1) + "å††";
            document.getElementById('wage-val').innerText = realInc < 0 ? "ğŸš¨ ç ´ç¶»" : (realInc > 105 ? "âœ¨ å‘ä¸Š" : (realInc < 90 ? "ğŸ”» æ·±åˆ»" : "ç¶­æŒ"));

            // åå¿œãƒ­ã‚°
            let alog = "";
            if (greedLevel > 80) alog += "ã€è¡€æ “ã€‘ä¼æ¥­ãŒåˆ©ç›Šã‚’æºœã‚è¾¼ã¿ã™ãã§ã™ã€‚å®¶è¨ˆã«ãŠé‡‘ãŒå›ã£ã¦ã„ã¾ã›ã‚“ã€‚<br>";
            if (bal > 0) alog += "ã€è­¦å‘Šã€‘æ”¿åºœãŒé»’å­—ã€‚æ°‘é–“ã‹ã‚‰ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¥ªã„ã™ãã¦ã„ã¾ã™ã€‚<br>";
            document.getElementById('boj-briefing').innerHTML = alog || "å¸‚å ´ã¨å®Ÿä½“ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ç›£è¦–ä¸­...";

            document.getElementById('react-gov').innerHTML = `ğŸ›ï¸ <b>æ”¿åºœ:</b> ${bal < -100 ? 'èµ¤å­—éå¤§ã«æ‚²é³´' : 'æ”¯æŒç‡ã‚’ç¶­æŒã—ãŸã„'}`;
            document.getElementById('react-biz').innerHTML = `ğŸ­ <b>çµŒæ¸ˆç•Œ:</b> ${greedLevel < 30 ? 'è³ƒä¸Šã’è² æ‹…ã«ä¸æº€' : 'å†…éƒ¨ç•™ä¿ã‚’å„ªå…ˆä¸­'}`;
            document.getElementById('react-home').innerHTML = `ğŸ  <b>å®¶è¨ˆ:</b> ${realInc < 0 ? 'æ‰‹å–ã‚ŠãŒèµ¤å­—ã€‚ç”Ÿå­˜ä¸èƒ½' : (realInc > 100 ? 'ã‚ˆã†ã‚„ãå¾ªç’°ã‚’æ„Ÿã˜ã‚‹' : 'ç‰©ä¾¡ã¨ãƒ­ãƒ¼ãƒ³ã®æ¿æŒŸã¿')}`;
        }

        function togglePolicy(id) { p[id] = !p[id]; document.getElementById(id).classList.toggle('active'); update(); }

        async function syncWorld() {
            const feed = document.getElementById('news-feed');
            feed.innerHTML = "> é€šä¿¡ä¸­...";
            try {
                const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent('https://news.google.com/rss/search?q=æ—¥éŠ€+é‡‘åˆ©+çµŒæ¸ˆ&hl=ja&gl=JP&ceid=JP:ja')}`);
                const data = await response.json();
                feed.innerHTML = data.items.slice(0,3).map(i => `> ${i.title}`).join('<br>');
                usaRate = 5.25; // åŒæœŸæ™‚ã¯ç¾åœ¨ã®é«˜æ°´æº–ã‚’ã‚»ãƒƒãƒˆ
                update();
            } catch (e) {
                feed.innerHTML = "> [OFFLINE] äºˆæ¸¬æƒ…å‹¢ã‚’é©ç”¨ä¸­<br>> å††å®‰155å††å°ã€‚ç±³FRBã¯æ…é‡å§¿å‹¢ã€‚";
                usaRate = 5.00; 
                update();
            }
        }
        document.getElementById('rate-slider').addEventListener('input', e => { currentRate = parseFloat(e.target.value); update(); });
        document.getElementById('greed-slider').addEventListener('input', e => { greedLevel = parseInt(e.target.value); update(); });
        setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString(); }, 1000);
        update();
    </script>
</body>
</html>
