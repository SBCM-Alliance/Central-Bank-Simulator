<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­å¤®éŠ€è¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #1a237e; --accent: #ffd600; --bg: #f5f7f9; --dark: #263238; --error: #d32f2f; --success: #2e7d32; --market: #0288d1; --real: #f4511e; --gov: #673ab7; }
        body { font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif; background-color: var(--bg); color: #333; margin: 0; padding: 15px; line-height: 1.5; }
        .container { max-width: 1250px; margin: 0 auto; display: flex; flex-direction: column; gap: 15px; }
        @media (min-width: 992px) { .container { display: grid; grid-template-columns: 420px 1fr; gap: 25px; } }
        .card { background: #fff; padding: 22px; border-radius: 14px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin-bottom: 10px; }
        h1 { color: var(--primary); font-size: 1.1rem; margin: 0 0 15px 0; border-left: 5px solid var(--primary); padding-left: 12px; font-weight: bold; }
        .rate-display { font-size: 3.2rem; font-weight: bold; color: var(--primary); text-align: center; display: block; margin: 10px 0; }
        input[type="range"] { width: 100%; margin: 15px 0; height: 10px; cursor: pointer; }
        .btn-policy-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px; }
        .btn-policy { padding: 12px 8px; border: 2px solid #ddd; background: #fff; color: #444; font-size: 0.75rem; border-radius: 8px; cursor: pointer; font-weight: bold; text-align: center; transition: 0.2s; display: flex; flex-direction: column; justify-content: center; min-height: 70px; }
        .btn-policy:hover { border-color: var(--gov); background: #f3e5f5; }
        .btn-policy.active { background: var(--gov); color: white; border-color: var(--gov); }
        .btn-policy span { font-size: 0.55rem; opacity: 0.8; font-weight: normal; margin-top: 2px; line-height: 1.2; }
        .metric-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 15px; }
        .metric-card { background: #fff; border: 1px solid #ddd; padding: 12px; border-radius: 12px; text-align: center; }
        .val { font-size: 1.2rem; font-weight: bold; display: block; }
        .wallet-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px; }
        .wallet-stat { padding: 15px; border-radius: 10px; color: white; text-align: center; }
        .wallet-stat small { font-size: 0.65rem; opacity: 0.9; display: block; margin-bottom: 5px; }
        .wallet-stat .amount { font-size: 1.2rem; font-weight: bold; }
        .bg-income { background: #43a047; }
        .bg-outcome { background: #e53935; }
        .wallet-msg { font-size: 0.8rem; margin-top: 10px; color: #555; font-style: italic; background: #f0f0f0; padding: 8px; border-radius: 4px; border-left: 3px solid #ccc; }
        .reaction-item { padding: 10px; border-radius: 8px; font-size: 0.8rem; border: 1px solid #eee; margin-top: 8px; line-height: 1.4; }
        .bg-gov { background: #f1f8e9; border-left: 5px solid #689f38; }
        .bg-biz { background: #e3f2fd; border-left: 5px solid #1976d2; }
        .bg-home { background: #fff3e0; border-left: 5px solid #f57c00; }
        .footer-note { text-align: center; font-size: 0.7rem; color: #999; padding: 20px; }
    </style>
</head>
<body>

    <header style="text-align:center; padding: 10px 0 20px 0;">
        <h2 style="font-size:1.6rem; color:var(--primary); margin:0; font-weight: 900;">ğŸ¦ ä¸­å¤®éŠ€è¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>
        <div style="font-size:0.8rem; opacity:0.6; font-family: monospace;">Policy Integrated Monitor v2.0 | <span id="clock">--:--:--</span></div>
    </header>

    <div class="container">
        <div class="left">
            <div class="card" style="background: var(--dark); color:white; border:none;">
                <h1 style="color:white; border-left-color: var(--accent);">ğŸ“¡ ä¸–ç•Œæƒ…å‹¢ã‚’åŒæœŸ</h1>
                <button onclick="syncWorld()" style="background:var(--accent); border:none; width:100%; padding:12px; font-weight:bold; border-radius:8px; cursor:pointer; font-size:0.9rem;">æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’åŒæœŸ ğŸ”„</button>
                <div id="news-feed" style="background:#000; color:#00e676; padding:10px; font-family:monospace; font-size:0.75rem; height:80px; overflow-y:auto; margin-top:10px; border:1px solid #444;">> å¾…æ©Ÿä¸­...</div>
            </div>
            <div class="card">
                <h1>ğŸ›ï¸ é‡‘èãƒ»è³‡æœ¬ãƒ¬ãƒãƒ¼</h1>
                <small style="color:#666; font-weight: bold;">æ”¿ç­–é‡‘åˆ© [æ—¥æœ¬éŠ€è¡Œ]</small>
                <span class="rate-display" id="rate-display">0.75%</span>
                <input type="range" id="rate-slider" min="-0.1" max="5.0" step="0.05" value="0.75">
                <small style="color:#666; font-weight: bold;">å†…éƒ¨ç•™ä¿ã®å„ªå…ˆåº¦ (æ ªä¸»é‚„å…ƒ) [ä¼æ¥­]</small>
                <input type="range" id="greed-slider" min="0" max="100" step="1" value="50">
            </div>
            <div class="card" style="border-top: 6px solid #43a047;">
                <h1>ğŸ‘› æ”¿åºœã®è²¡å¸ƒï¼ˆæ¨™æº–ãƒ–ãƒ­ãƒƒã‚¯æ›ç®—ï¼‰</h1>
                <div class="wallet-grid">
                    <div class="wallet-stat bg-income"><small>ç¨å (å¾´å)</small><span class="amount" id="gov-income">--ä¸‡</span></div>
                    <div class="wallet-stat bg-outcome"><small>æ”¯å‡º (æ³¨å…¥)</small><span class="amount" id="gov-outcome">--ä¸‡</span></div>
                </div>
                <div id="wallet-balance" style="text-align:center; font-weight:bold; margin-top:10px; font-size:0.85rem;"></div>
                <div class="wallet-msg" id="wallet-msg">æ”¿åºœã®èµ¤å­—åˆ†ã€å®¶è¨ˆã«ãŠé‡‘ãŒå›ã£ã¦ã„ã¾ã™ã€‚</div>
            </div>
        </div>
        <div class="right">
            <div class="card">
                <h1>ğŸ“ˆ çµŒæ¸ˆæŒ‡æ¨™ (é’:å¸‚å ´ / æ©™:ç”Ÿæ´»)</h1>
                <div style="height: 300px;"><canvas id="mainChart"></canvas></div>
            </div>
            <div class="metric-grid">
                <div class="metric-card"><small>æƒ³å®šãƒ»å††ç›¸å ´</small><span class="val" id="yen-val">--å††</span></div>
                <div class="metric-card"><small>æ—¥ç±³é‡‘åˆ©å·®</small><span class="val" id="gap-val">--%</span></div>
                <div class="metric-card"><small>å®Ÿè³ªè³ƒé‡‘åˆ¤å®š</small><span class="val" id="wage-val">--</span></div>
            </div>
            <div class="card" style="border-top: 5px solid var(--error);">
                <h1>ğŸ‘¥ å„ç•Œã®åå¿œã¨æ‚²é³´</h1>
                <div class="reaction-item bg-gov" id="react-gov">ğŸ›ï¸ æ”¿åºœ: --</div>
                <div class="reaction-item bg-biz" id="react-biz">ğŸ­ çµŒæ¸ˆç•Œ: --</div>
                <div class="reaction-item bg-home" id="react-home">ğŸ  å®¶è¨ˆ: --</div>
                <div id="boj-briefing" style="font-size:0.8rem; color:#666; margin-top:10px; padding:8px; background:#fffde7; border-radius:4px;">æƒ…å‹¢ã‚’åŒæœŸã—ã¦ãã ã•ã„ã€‚</div>
            </div>
            <div class="card" style="border-top: 6px solid var(--gov); background: #f3e5f5;">
                <h1>ğŸ›ï¸ æ”¿åºœã®ä»‹å…¥æ”¿ç­–ï¼ˆå®Ÿè¡Œãƒ»è§£é™¤ã‚’åˆ‡ã‚Šæ›¿ãˆï¼‰</h1>
                <div class="btn-policy-grid">
                    <button class="btn-policy" id="p1" onclick="togglePolicy('p1')">æ‰€å¾—ç¨ãƒ»ç¤¾ä¿ã®å¤§æ¸›ç¨<span>å®¶è¨ˆã®ã€Œã‚¢ãƒ¼ã‚¹ã€ã‚’åŠ‡çš„å¼·åŒ–</span></button>
                    <button class="btn-policy" id="p2" onclick="togglePolicy('p2')">æ¶ˆè²»ç¨ã®å®Œå…¨å»ƒæ­¢<span>ã€æ³¨ã€‘å¼·çƒˆãªã‚¤ãƒ³ãƒ•ãƒ¬ã‚’èª˜ç™º</span></button>
                    <button class="btn-policy" id="p3" onclick="togglePolicy('p3')">ä¼æ¥­ã®è³ƒä¸Šã’ç¾©å‹™åŒ–<span>ä¼æ¥­åˆ©ç›Šã‚’å®¶è¨ˆã¸å¼·åˆ¶ç§»å‹•</span></button>
                    <button class="btn-policy" id="p4" onclick="togglePolicy('p4')">ä¸€å¾‹10ä¸‡å††çµ¦ä»˜<span>çŸ­æœŸçš„ã ãŒç‰©ä¾¡ã‚’æŠ¼ã—ä¸Šã’ã‚‹</span></button>
                    <button class="btn-policy" id="p5" onclick="togglePolicy('p5')">è¡Œæ”¿ãƒ»ITã®å¾¹åº•åŠ¹ç‡åŒ–<span>ã‚·ã‚¹ãƒ†ãƒ ã®ã€Œæ‘©æ“¦ã€ã‚’æ¸›ã‚‰ã™</span></button>
                    <button class="btn-policy" id="p6" onclick="togglePolicy('p6')">é£Ÿæ–™ãƒ»ã‚¨ãƒè‡ªçµ¦æŠ•è³‡<span>ã€5å¹´ã€‘æŠ•è³‡ã«ã‚ˆã‚‹èµ¤å­—ã¨æ­ªã¿å¢—</span></button>
                    <button class="btn-policy" id="p7" onclick="togglePolicy('p7')">å…¬å…±äº‹æ¥­ã®ãƒãƒ©ãƒã‚­<span>ã€æ³¨ã€‘å¤§æ‰‹ã¨æ±äº¬ã«é‡‘ãŒæ¼ã‚Œã‚‹</span></button>
                    <button class="btn-policy" id="p8" onclick="togglePolicy('p8')">ç·Šç¸®è²¡æ”¿ï¼ˆè¦å¾‹é‡è¦–ï¼‰<span>ã€æ³¨ã€‘å®¶è¨ˆã‹ã‚‰ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å›å</span></button>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer-note">
        â€» å®Ÿéš›ã®çµŒæ¸ˆè²¬ä»»ã¯åˆ†æ•£ã—ã¦ãŠã‚Šã€å˜ç‹¬ã§ã®åˆ¶å¾¡ã¯ä¸å¯èƒ½ã§ã™ã€‚ãƒã‚¤ãƒŠã‚¹ã®æ‰‹å–ã‚Šã¯ã€Œå®¶è¨ˆã®ç ´ç¶»ã€ã‚’æ„å‘³ã—ã¾ã™ã€‚<br>
        Â© 2026 SBCM Alliance
    </footer>

    <script>
        let currentRate = 0.75;
        let greedLevel = 50;
        let usaRate = 4.75;
        let p = { p1: false, p2: false, p3: false, p4: false, p5: false, p6: false, p7: false, p8: false };

        const ctx = document.getElementById('mainChart').getContext('2d');
        const mainChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['æ ªä¾¡', 'å††ä¾¡å€¤', 'ç‰©ä¾¡', 'ãƒ­ãƒ¼ãƒ³', 'æ‰‹å–ã‚Š'],
                datasets: [{
                    data: [100, 100, 100, 100, 100],
                    backgroundColor: ['#0288d1', '#03a9f4', '#f4511e', '#ff7043', '#fb8c00'],
                    borderRadius: 6
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: -150, max: 200, grid: { color: '#eee' } } }, plugins: { legend: { display: false } } }
        });

        function update() {
            document.getElementById('rate-display').innerText = currentRate.toFixed(2) + "%";
            const gap = usaRate - currentRate;
            document.getElementById('gap-val').innerText = gap.toFixed(2) + "%";

            // 1. æ”¿åºœã®è²¡å¸ƒ
            let bInc = 150; let bOut = 200;
            let inflationShield = 1.0;
            let structureDistortion = 1.0;
            let efficiency = 1.0;
            let incomeBonus = 0;
            let inflationPush = 0;

            if (p.p1) bInc -= 40; 
            if (p.p2) { bInc -= 60; inflationPush += 40; }
            if (p.p8) bOut -= 50;
            if (p.p4) { bOut += 70; inflationPush += 15; }
            if (p.p7) { bOut += 40; structureDistortion += 0.3; }
            if (p.p5) { efficiency = 0.75; bOut -= 10; }
            
            // P6: è‡ªçµ¦è‡ªè¶³æŠ•è³‡ã®ãƒ‡ãƒãƒƒã‚°ï¼ˆ5å¹´ã‚¹ãƒ‘ãƒ³ï¼šæŠ•è³‡æœŸï¼‰
            if (p.p6) {
                bOut += 50;              // å·¨é¡ã®å»ºè¨­ãƒ»è¨­å‚™æŠ•è³‡
                structureDistortion += 0.15; // å›½å®¶ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç‰¹æœ‰ã®æ­ªã¿
                inflationShield = 0.95;   // 5å¹´ã§ã¯3-5%ç¨‹åº¦ã®å¾®å°ãªé˜²å¾¡åŠ¹æœ
                inflationPush += 5;       // å…¬å…±æŠ•è³‡ã«ã‚ˆã‚‹éœ€è¦å¢—ãŒã‚¤ãƒ³ãƒ•ãƒ¬ã‚’åŠ©é•·
            }

            let totalOut = bOut + (currentRate * 15);
            let totalInc = bInc + (greedLevel > 70 ? 10 : 0);
            document.getElementById('gov-income').innerText = Math.round(totalInc) + "ä¸‡";
            document.getElementById('gov-outcome').innerText = Math.round(totalOut) + "ä¸‡";
            let bal = totalInc - totalOut;
            document.getElementById('wallet-balance').innerText = bal < 0 ? `è²¡æ”¿èµ¤å­—: ${Math.abs(Math.round(bal))}ä¸‡ (ç¤¾ä¼šã¸æ”¾å‡º)` : `è²¡æ”¿é»’å­—: ${Math.round(bal)}ä¸‡ (ç¤¾ä¼šã‹ã‚‰å›å)`;
            document.getElementById('wallet-balance').style.color = bal < 0 ? 'var(--real)' : 'var(--success)';

            // 2. æŒ‡æ¨™è¨ˆç®—
            incomeBonus = (totalOut - totalInc) * 0.7 + (p.p3 ? greedLevel*0.4 : 0);
            const stock = (100 - (currentRate * 10) + (usaRate * 4) + (greedLevel * 0.3) + (p.p7 ? 20 : 0)) / structureDistortion;
            const yenVal = 100 - (gap * 9); 
            const inflation = (100 + (gap * 15) - (currentRate * 8) + inflationPush) * inflationShield;
            const mortgage = (100 + (currentRate * 55)) * efficiency;
            let realInc = 100 + incomeBonus - ((inflation - 100) * 1.8) - ((mortgage - 100) * 1.0) + (currentRate * 2);

            mainChart.data.datasets[0].data = [stock, yenVal, inflation, mortgage, realInc];
            mainChart.data.datasets[0].backgroundColor[4] = realInc < 0 ? '#b71c1c' : (realInc > 110 ? '#2ecc71' : '#fb8c00');
            mainChart.update();

            document.getElementById('yen-val').innerText = (142 + (gap * 4.8)).toFixed(1) + "å††";
            document.getElementById('wage-val').innerText = realInc < 0 ? "ğŸš¨ ç ´ç¶»" : (realInc > 105 ? "âœ¨ å‘ä¸Š" : "ğŸ”» ä½ä¸‹");

            // çŠ¶æ³å ±å‘Š
            let alog = "";
            if (p.p6) alog += "ã€åˆ†æã€‘è‡ªçµ¦æŠ•è³‡ã‚’å®Ÿè¡Œä¸­ã€‚ç¾åœ¨ã¯ã‚³ã‚¹ãƒˆå…ˆè¡ŒæœŸã§ã‚ã‚Šã€è²¡å¸ƒã¨ç‰©ä¾¡ã‚’åœ§è¿«ã—ã¦ã„ã¾ã™ãŒå°†æ¥ã®ç›¾ã‚’æ§‹ç¯‰ä¸­ã§ã™ã€‚<br>";
            if (bal > 0) alog += "ã€è­¦å‘Šã€‘æ”¿åºœãŒé»’å­—ã€‚æ°‘é–“ã‹ã‚‰ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¸ã„ä¸Šã’ã™ãã¦ãŠã‚Šã€å®Ÿä½“çµŒæ¸ˆãŒçª’æ¯ã—ã¦ã„ã¾ã™ã€‚<br>";
            if (p.p2 && inflation > 140) alog += "ã€æ‚²é³´ã€‘æ¶ˆè²»ç¨å»ƒæ­¢ã«ã‚ˆã‚‹ç†±æš´èµ°ãŒæ­¢ã¾ã‚Šã¾ã›ã‚“ã€‚ç”Ÿæ´»ãŒç„¼ã‘é‡åŸã§ã™ã€‚<br>";
            document.getElementById('boj-briefing').innerHTML = alog || "ç¾çŠ¶ã¯å‡è¡¡ã—ã¦ã„ã¾ã™ãŒã€å¤–éƒ¨ã‹ã‚‰ã®å††å®‰ç†±ã‚’åˆ¶å¾¡ã—ãã‚Œã¦ã„ã¾ã›ã‚“ã€‚";

            document.getElementById('react-gov').innerHTML = `ğŸ›ï¸ <b>æ”¿åºœ:</b> ${bal < -100 ? 'èµ¤å­—çˆ†ç™ºã§è²¡å‹™çœãŒãƒ‘ãƒ‹ãƒƒã‚¯' : 'æ”¯æŒç‡ã‚’æ°—ã«ã—ã¦ã„ã¾ã™'}`;
            document.getElementById('react-biz').innerHTML = `ğŸ­ <b>çµŒæ¸ˆç•Œ:</b> ${p.p3 ? 'è³ƒä¸Šã’å¼·åˆ¶ã«çŒ›æŠ—è­°' : 'ä½é‡‘åˆ©ã®ç¶­æŒã‚’è¦æ±‚'}`;
            document.getElementById('react-home').innerHTML = `ğŸ  <b>å®¶è¨ˆ:</b> ${realInc < 0 ? 'ä¸€æ†å¯¸å‰ã€‚ç”Ÿå­˜ãŒå±ã†ã„' : (realInc > 100 ? 'ã‚ˆã†ã‚„ãå¾ªç’°ã‚’æ„Ÿã˜ã‚‹' : 'ç‰©ä¾¡ã¨ãƒ­ãƒ¼ãƒ³ã®æ¿æŒŸã¿')}`;
        }

        function togglePolicy(id) { p[id] = !p[id]; document.getElementById(id).classList.toggle('active'); update(); }

        async function syncWorld() {
            const feed = document.getElementById('news-feed');
            feed.innerHTML = "> é€šä¿¡ä¸­...";
            try {
                const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent('https://news.google.com/rss/search?q=æ—¥éŠ€+é‡‘åˆ©+çµŒæ¸ˆ&hl=ja&gl=JP&ceid=JP:ja')}`);
                const data = await response.json();
                feed.innerHTML = data.items.slice(0,3).map(i => `> ${i.title}`).join('<br>');
                usaRate = 5.25; update();
            } catch (e) {
                feed.innerHTML = "> [OFFLINE] 2026å¹´äºˆæ¸¬ãƒ‡ãƒ¼ã‚¿ã‚’é©ç”¨ä¸­...<br>> å††å®‰155å††å°ã€‚ç±³FRBã€åˆ©ä¸‹ã’ã«æ…é‡å§¿å‹¢ã€‚";
                usaRate = 5.00; update();
            }
        }

        document.getElementById('rate-slider').addEventListener('input', e => { currentRate = parseFloat(e.target.value); update(); });
        document.getElementById('greed-slider').addEventListener('input', e => { greedLevel = parseInt(e.target.value); update(); });
        setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString(); }, 1000);
        update();
    </script>
</body>
</html>
